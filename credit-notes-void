//********** API KEY ***************
// INGRESE AQUÍ EL API KEY DE SU CUENTA DE efacturapty

apiKey = "INGRESE AQUI SU API KEY";

//**********************************
resultMap = Map();
customFieldList = creditnote.get("custom_fields").toJSONList();
cufeCustomField = null;
for each  customField in customFieldList
{
	if(customField.get("label") == "CUFE")
	{
		cufeCustomField = customField;
		break;
	}
}
resultMap.put("cufe",cufeCustomField.get("value"));
resultMap.put("reason","Anulación desde ZohoBooks");
headers = Map();
headers.put("ApiKeyEfactura",apiKey);
headers.put("Accept-Language","es-PA");
headers.put("Content-Type","application/x-www-form-urlencoded");

autorizacion = invokeurl
[
	url :"https://hub.efacturapty.com/Zoho/VoidInvoice"
	type :POST
	parameters:resultMap
	headers:headers
];
resultMap.put("response",autorizacion);
resultMap.put("message","Factura anulada con exito");
resultMap.put("code",0);

return resultMap;
